<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Route 1.2 Telok Ayer St (Chinatown) ‚Üí Clive St (Little India)</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body {
      margin: 0;
      font-family: Poppins, sans-serif;
      background: #f0f8ff;
      text-align: center;
    }

    .back-link {
      display: inline-block;
      margin: 10px;
      padding: 8px 14px;
      background: #0077b6;
      color: #fff;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 500;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .back-link:hover {
      background-color: #005f87;
    }

    h2 {
      margin: 4px 12px 2px;
      font-size: 1.2em;
    }

    #map {
      height: 55vh;
      width: 95%;
      border-radius: 12px;
      margin: 5px auto;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    #remark-box {
      font-size: 1em;
      margin-top: 8px;
      padding: 10px;
      background: #fff8dc;
      border-radius: 8px;
      width: 90%;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      min-height: 2.4em;
    }

    .controls {
      margin-top: 10px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    button {
      padding: 8px 18px;
      font-size: 0.95em;
      margin: 5px 3px;
      border: none;
      border-radius: 6px;
      background-color: #0077b6;
      color: white;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    button:hover {
      background-color: #005f87;
    }
    button:disabled {
      background-color: #a0c4ff;
      cursor: not-allowed;
    }

    .toggle-wrapper {
      margin-top: 6px;
      font-size: 0.9em;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
    }
    .toggle-wrapper input[type="checkbox"] {
      transform: scale(1.1);
      cursor: pointer;
    }

    /* LEGEND */
    #legend-box {
      position: fixed;
      top: 20px;
      right: 15px;
      background: #ffffffcc;
      padding: 10px 12px;
      border-radius: 8px;
      font-size: 0.85em;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      text-align: left;
      line-height: 1.4em;
      z-index: 9999;
    }
    .light {
      display: inline-block;
      width: 11px;
      height: 11px;
      margin-right: 6px;
      border-radius: 50%;
    }
    .light.red { background: red; }
    .light.amber { background: orange; }
    .light.green { background: green; }

    /* PROGRESS BAR */
    #progress-container {
      width: 90%;
      height: 10px;
      background: #e0e0e0;
      border-radius: 6px;
      margin: 15px auto 5px;
      overflow: hidden;
    }
    #progress-bar {
      width: 0%;
      height: 100%;
      background: #0077b6;
      transition: width 0.2s linear;
    }
    #progress-text {
      font-size: 0.9em;
      color: #333;
      margin-bottom: 10px;
    }

    /* TIMER */
    #timer-box {
      margin-top: 8px;
      font-size: 1.1em;
      font-weight: 600;
      color: #023e8a;
    }

    /* SPEED CONTROL */
    #speed-control {
      margin-top: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      font-size: 0.9em;
    }
    #speedSlider {
      width: 160px;
    }
    #speed-label {
      font-weight: 600;
      color: #024b84;
    }

    /* LOWER PANELS */
    .bottom-panels {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      width: 95%;
      margin: 10px auto 20px;
    }

    #narration-panel, #checkpoints-panel {
      background: #ffffff;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      padding: 10px 12px;
      font-size: 0.9em;
      text-align: left;
      flex: 1 1 260px;
      max-width: 360px;
    }

    #narration-panel h3,
    #checkpoints-panel h3 {
      margin: 0 0 6px;
      font-size: 1em;
      color: #023e8a;
    }

    #current-narration,
    #next-narration {
      margin: 3px 0;
    }

    #checkpoints-panel ul {
      list-style: none;
      padding-left: 0;
      margin: 4px 0 0;
      max-height: 180px;
      overflow-y: auto;
    }

    #checkpoints-panel li {
      margin-bottom: 4px;
      font-size: 0.88em;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .checkpoint-icon {
      font-size: 0.9em;
      width: 18px;
      text-align: center;
    }

    .checkpoint.done {
      color: green;
      text-decoration: line-through;
    }

    /* MINI-MAP */
    #mini-map-container {
      position: fixed;
      bottom: 15px;
      right: 15px;
      width: 180px;
      height: 130px;
      background: #ffffffcc;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
      z-index: 9998;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    #mini-map-title {
      font-size: 0.8em;
      padding: 4px 6px;
      background: #0077b6;
      color: #fff;
      text-align: left;
    }
    #mini-map {
      flex: 1;
    }

    @media (min-width: 768px) {
      h2 { font-size: 1.5em; }
      #map { height: 60vh; width: 90%; }
      #remark-box { font-size: 1.05em; width: 80%; }
    }
  </style>
</head>
<body>
  <a href="index.html" class="back-link">‚¨Ö Back to Home</a>

  <h2>üöó Singapore Route Tracker ‚Äì Telok Ayer St (Chinatown) to Clive St (Little India)</h2>

  <div id="map"></div>

  <div id="remark-box">Start of the route...</div>

  <!-- LEGEND -->
  <div id="legend-box">
    <strong>Traffic Lights</strong><br>
    <span class="light red"></span> Red ‚Äì Stop<br>
    <span class="light amber"></span> Amber ‚Äì Prepare to Stop<br>
    <span class="light green"></span> Green ‚Äì Moving
  </div>

  <!-- PROGRESS BAR -->
  <div id="progress-container">
    <div id="progress-bar"></div>
  </div>
  <div id="progress-text">Progress: 0%</div>

  <!-- TIMER -->
  <div id="timer-box">‚è± 00:00</div>

  <!-- SPEED CONTROL -->
  <div id="speed-control">
    <span>Speed:</span>
    <input type="range" id="speedSlider" min="1" max="3" step="1" value="2" />
    <span id="speed-label">Normal</span>
  </div>

  <!-- MAIN CONTROLS -->
  <div class="controls">
    <button id="startBtn">‚ñ∂ Start</button>
    <button id="stopBtn" disabled>‚èπ Stop</button>
    <button id="prevBtn">‚è™ Previous</button>
    <button id="resetBtn">üîÅ Reset</button>
  </div>

  <div class="toggle-wrapper">
    <label for="voiceToggle">üîä Voice narration</label>
    <input type="checkbox" id="voiceToggle" checked />
  </div>

  <!-- PANELS -->
  <div class="bottom-panels">
    <div id="narration-panel">
      <h3>Auto-Narration</h3>
      <div id="current-narration"><strong>Current:</strong> None yet ‚Äî starting soon.</div>
      <div id="next-narration"><strong>Next:</strong> Harmony in Diversity Gallery</div>
    </div>

    <div id="checkpoints-panel">
      <h3>Milestone Checkpoints</h3>
      <ul id="checkpoint-list"></ul>
    </div>
  </div>

  <!-- MINI MAP -->
  <div id="mini-map-container">
    <div id="mini-map-title">Mini Overview</div>
    <div id="mini-map"></div>
  </div>

  <audio id="narrationPlayer"></audio>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="js/engine.js"></script>
  <script>
    const ROUTE_CONFIG = {
      heading: "üöó Singapore Route Tracker ‚Äì Telok Ayer to Little India",
      initialView: { lat: 1.288, lng: 103.847, zoom: 15 },
      audioBasePath: "audio/",
      route: [
        [1.2809237531476467, 103.84772308757975],
        [1.280556382311, 103.84753130963628],
        [1.2800911352287887, 103.84730600407863],
        [1.279857841275584, 103.84719871571723],
        [1.2797559427542893, 103.8470793574159],
        [1.279839070492907, 103.84686209848597],
        [1.2800401859725303, 103.84670250704836],
        [1.2804786667087158, 103.84687330386893],
        [1.2810193384837059, 103.84714076229598],
        [1.2816334107669611, 103.84749481388512],
        [1.28235206283833, 103.84792933174884],
        [1.2825102735500917, 103.84801248022535],
        [1.2827382041881337, 103.84760478445199],
        [1.2831723096502492, 103.84686224079424],
        [1.2836091360851134, 103.84621016680057],
        [1.2842493340347951, 103.84510428162625],
        [1.2865868025548797, 103.84521926453954],
        [1.2872947271051387, 103.84582544378152],
        [1.2873022799648421, 103.84585763028599],
        [1.2879029430716329, 103.84635383895534],
        [1.28835880337836, 103.8467588525155],
        [1.289232614275258, 103.84746421038592],
        [1.2896149859503454, 103.84776367518376],
        [1.289799941798337, 103.84791199632996],
        [1.2899996107885479, 103.84807972810025],
        [1.2908776188971924, 103.84868639623232],
        [1.2923365250778196, 103.84943688154169],
        [1.2936130777105002, 103.84999608930715],
        [1.2944309779998084, 103.85048571510042],
        [1.2948076663761237, 103.85072947110777],
        [1.2959742997694592, 103.85179441281011],
        [1.296515427077307, 103.85232826172465],
        [1.2968992328944737, 103.85266868965019],
        [1.297673780572257, 103.85329674346436],
        [1.2984251869349277, 103.85388838134003],
        [1.29869245094337, 103.85373937624408],
        [1.299075465281629, 103.85329436418576],
        [1.2997069018820073, 103.85251577913701],
        [1.3009359312082351, 103.85089579749119],
        [1.3014936868058822, 103.85015550779744],
        [1.3018101057920066, 103.8500160329276],
        [1.3027755744861385, 103.85004047508748],
        [1.3033368253439588, 103.85007840724977],
        [1.3046072237420665, 103.85050324748381],
        [1.3051002139865446, 103.8508787759069],
        [1.3048650955743026, 103.85121257894964],
        [1.304720179698739, 103.8514325678856],
        [1.3047846476563814, 103.85159567619057],
        [1.3051342530781134, 103.85187494131259],
        [1.3053371918132015, 103.85215461834413],
        [1.3054630605341935, 103.85232245106917]
      ],
      landmarks: [
        {
          name: "Harmony in Diversity Gallery",
          coords: [1.2796781780954223, 103.84689830830601],
          remark: "Amoy St. (Left) Harmony in Diversity Gallery",
          audioId: "harmony_in_diversity_gallery"
        },
        {
          name: "Siang Cho Kong Temple",
          coords: [1.2798471151123931, 103.84662204077732],
          remark: "Amoy St. (Left) Siang Cho Kong Temple",
          audioId: "siang_cho_kong_temple"
        },
        {
          name: "Sook Ching Inspection Centre",
          coords: [1.2840262851370199, 103.84636189545638],
          remark: "Cross St. (Right) Sook Ching Inspection Centre",
          audioId: "sook_ching_inspection_centre"
        },
        {
          name: "Hong Lim Park / Speaker's Corner",
          coords: [1.2867257504987055, 103.84573424867432],
          remark: "Eu Tong Sen St. (Right) Hong Lim Park / Speaker's Corner",
          audioId: "hong_lim_park"
        },
        {
          name: "Chinatown View Overhead Bridge",
          coords: [1.2889510536122653, 103.84716916739205],
          remark: "Eu Tong Sen St. (Top) Chinatown View Overhead Bridge",
          audioId: "chinatown_overhead_bridge"
        },
        {
          name: "Old Hill St. Police Station",
          coords: [1.2909593241007833, 103.84828202056978],
          remark: "Eu Tong Sen St. (Ahead) Old Hill St. Police Station",
          audioId: "old_hill_st_police_station"
        },
        {
          name: "Singapore Management University (SMU)",
          coords: [1.2953328760033045, 103.85053423408635],
          remark: "Victoria St. (Left) Singapore Management University (SMU)",
          audioId: "smu"
        },
        {
          name: "CHIJMES",
          coords: [1.295334344360328, 103.8519256455288],
          remark: "Victoria St. (Right) CHIJMES",
          audioId: "chijmes"
        },
        {
          name: "Cathedral of the Good Shepherd",
          coords: [1.2959523928610526, 103.85138684004768],
          remark: "Victoria St. (Left) Cathedral of the Good Shepherd",
          audioId: "good_shepherd"
        },
        {
          name: "National Design Centre",
          coords: [1.2984952889726529, 103.85357941489109],
          remark: "Victoria St / Middle Road. (Left) National Design Centre",
          audioId: "national_design_centre"
        },
        {
          name: "Nanyang Academy of Fine Arts (NAFA)",
          coords: [1.3000885715066572, 103.85179165530897],
          remark: "Middle Rd. (Left) Nanyang Academy of Fine Arts (NAFA)",
          audioId: "nafa"
        },
        {
          name: "Tekka Place",
          coords: [1.3050926295219747, 103.85141361941857],
          remark: "Selegie Rd. (Ahead) Tekka Place",
          audioId: "tekka_place"
        },
        {
          name: "Indian Heritage Centre",
          coords: [1.3057475789552717, 103.85216589564395],
          remark: "Clive St. (Left) Indian Heritage Centre",
          audioId: "indian_heritage_centre"
        }
      ],
      trafficLights: [
        {
          name: "Telok Ayer / Amoy Junction",
          coords: [1.2797559427542893, 103.8470793574159],
          cycle: { green: 25, amber: 3, red: 35 },
          offset: 0
        },
        {
          name: "Amoy / Cross St Junction",
          coords: [1.2825102735500917, 103.84801248022535],
          cycle: { green: 24, amber: 3, red: 36 },
          offset: 10
        },
        {
          name: "Cross / Upper Cross Junction",
          coords: [1.2842493340347951, 103.84510428162625],
          cycle: { green: 22, amber: 3, red: 33 },
          offset: 18
        },
        {
          name: "Upper Cross / Eu Tong Sen",
          coords: [1.2865868025548797, 103.84521926453954],
          cycle: { green: 26, amber: 3, red: 38 },
          offset: 5
        },
        {
          name: "Selegie / Sungei Rd",
          coords: [1.3051002139865446, 103.8508787759069],
          cycle: { green: 20, amber: 3, red: 32 },
          offset: 12
        },
        {
          name: "Sungei / Clive St",
          coords: [1.3053371918132015, 103.85215461834413],
          cycle: { green: 20, amber: 3, red: 30 },
          offset: 7
        }
      ]
    };

    initRoute(ROUTE_CONFIG);
  </script>
</body>
</html>
